<html><head>
<title>multiplot.py</title>
<meta name="Generator" content="htmlizer/[twisted, version 16.0.0]" />
<link rel="alternate" href="multiplot.py" type="text/x-python" />

</head>
<body>
<pre><span class="py-src-comment">#! /usr/bin/env python</span>
<span class="py-src-comment"># -*- conding: utf-8 -*-</span>
<span class="py-src-comment">#import matplotlib</span>
<span class="py-src-keyword">import</span> <span class="py-src-variable">csv</span>
<span class="py-src-keyword">import</span> <span class="py-src-variable">matplotlib</span>.<span class="py-src-variable">pyplot</span> <span class="py-src-keyword">as</span> <span class="py-src-variable">plt</span>
<span class="py-src-keyword">import</span> <span class="py-src-variable">pandas</span> <span class="py-src-keyword">as</span> <span class="py-src-variable">pd</span>
<span class="py-src-keyword">import</span> <span class="py-src-variable">numpy</span> <span class="py-src-keyword">as</span> <span class="py-src-variable">np</span>
<span class="py-src-keyword">from</span> <span class="py-src-variable">matplotlib</span>.<span class="py-src-variable">dates</span> <span class="py-src-keyword">import</span> <span class="py-src-variable">DateFormatter</span>, <span class="py-src-variable">DayLocator</span>
<span class="py-src-variable">font</span> = {<span class="py-src-string">'family'</span>: <span class="py-src-string">'serif'</span>,
        <span class="py-src-string">'color'</span> : <span class="py-src-string">'darkred'</span>,
        <span class="py-src-string">'weight'</span>: <span class="py-src-string">'normal'</span>,
        <span class="py-src-string">'size'</span>  : <span class="py-src-number">10</span>,
        }
<span class="py-src-variable">axis_font</span> = {<span class="py-src-string">'fontname'</span>:<span class="py-src-string">'Arial'</span>, <span class="py-src-string">'size'</span>:<span class="py-src-string">'8'</span>}

<span class="py-src-keyword">def</span> <span class="py-src-identifier">multiplot</span>(<span class="py-src-parameter">df</span>, <span class="py-src-parameter">collist</span>, <span class="py-src-parameter">plottypelist</span>, <span class="py-src-parameter">directions</span>, <span class="py-src-parameter">colorlist</span>):
    <span class="py-src-variable">axnum</span>=<span class="py-src-variable">len</span>(<span class="py-src-variable">collist</span>)
    <span class="py-src-variable">bottomsum</span>=[<span class="py-src-number">0</span>*<span class="py-src-variable">len</span>(<span class="py-src-variable">df</span>.<span class="py-src-variable">index</span>)]
    <span class="py-src-variable">plt</span>.<span class="py-src-variable">style</span>.<span class="py-src-variable">use</span>(<span class="py-src-string">'classic'</span>)
    <span class="py-src-keyword">for</span> <span class="py-src-variable">i</span> <span class="py-src-keyword">in</span> <span class="py-src-variable">range</span>(<span class="py-src-variable">axnum</span>):
        <span class="py-src-variable">ax</span> = <span class="py-src-variable">plt</span>.<span class="py-src-variable">subplot</span>(<span class="py-src-variable">axnum</span>,<span class="py-src-number">1</span>,<span class="py-src-variable">i</span>+<span class="py-src-number">1</span>)
        <span class="py-src-keyword">if</span> <span class="py-src-string">'line'</span> == <span class="py-src-variable">plottypelist</span>[<span class="py-src-variable">i</span>]:
            <span class="py-src-keyword">if</span> <span class="py-src-variable">isinstance</span>(<span class="py-src-variable">collist</span>[<span class="py-src-variable">i</span>],<span class="py-src-variable">str</span>): <span class="py-src-comment">#list, str,int,etc</span>
                <span class="py-src-variable">ax</span>.<span class="py-src-variable">plot</span>(<span class="py-src-variable">df</span>.<span class="py-src-variable">index</span>, <span class="py-src-variable">df</span>[<span class="py-src-variable">collist</span>[<span class="py-src-variable">i</span>]], <span class="py-src-variable">linewidth</span>= <span class="py-src-number">0.4</span>, <span class="py-src-variable">color</span>= <span class="py-src-variable">colorlist</span>[<span class="py-src-variable">i</span>])
                <span class="py-src-variable">ax</span>.<span class="py-src-variable">get_xaxis</span>().<span class="py-src-variable">set_ticks</span>([])
                <span class="py-src-variable">plt</span>.<span class="py-src-variable">title</span>(<span class="py-src-variable">collist</span>[<span class="py-src-variable">i</span>])
            <span class="py-src-keyword">elif</span> <span class="py-src-variable">isinstance</span>(<span class="py-src-variable">collist</span>[<span class="py-src-variable">i</span>],<span class="py-src-variable">list</span>):
                <span class="py-src-variable">axlegend</span>=[]
                <span class="py-src-variable">axtwinlegend</span>=[]
                <span class="py-src-variable">axtwinxCreateFlag</span>=<span class="py-src-string">''</span>
                <span class="py-src-keyword">for</span> <span class="py-src-variable">j</span> <span class="py-src-keyword">in</span> <span class="py-src-variable">range</span>(<span class="py-src-variable">len</span>(<span class="py-src-variable">collist</span>[<span class="py-src-variable">i</span>])):
                    <span class="py-src-keyword">if</span> <span class="py-src-variable">directions</span>[<span class="py-src-variable">i</span>][<span class="py-src-variable">j</span>] == <span class="py-src-string">'L'</span>:
                        <span class="py-src-variable">ax</span>.<span class="py-src-variable">plot</span>(<span class="py-src-variable">df</span>.<span class="py-src-variable">index</span>, <span class="py-src-variable">df</span>[<span class="py-src-variable">collist</span>[<span class="py-src-variable">i</span>][<span class="py-src-variable">j</span>]], <span class="py-src-variable">linewidth</span> = <span class="py-src-number">0.4</span>, <span class="py-src-variable">color</span>= <span class="py-src-variable">colorlist</span>[<span class="py-src-variable">i</span>][<span class="py-src-variable">j</span>])
                        <span class="py-src-variable">ax</span>.<span class="py-src-variable">set_ylabel</span>(<span class="py-src-variable">collist</span>[<span class="py-src-variable">i</span>][<span class="py-src-variable">j</span>], **<span class="py-src-variable">axis_font</span>)
                        <span class="py-src-variable">ax</span>.<span class="py-src-variable">yaxis</span>.<span class="py-src-variable">label</span>.<span class="py-src-variable">set_color</span>(<span class="py-src-variable">colorlist</span>[<span class="py-src-variable">i</span>][<span class="py-src-variable">j</span>])
                        <span class="py-src-variable">axlegend</span>.<span class="py-src-variable">append</span>(<span class="py-src-variable">collist</span>[<span class="py-src-variable">i</span>][<span class="py-src-variable">j</span>])
                      <span class="py-src-comment">#  ax.legend([collist[i][j]], ncol=len(collist[i])/2+1, loc = 'upper left', fontsize =8)</span>
                    <span class="py-src-keyword">else</span>:
                        <span class="py-src-keyword">if</span> <span class="py-src-variable">axtwinxCreateFlag</span>==<span class="py-src-string">''</span>:
                            <span class="py-src-variable">axy</span>=<span class="py-src-variable">ax</span>.<span class="py-src-variable">twinx</span>()
                            <span class="py-src-variable">axtwinxCreateFlag</span>=<span class="py-src-string">'Y'</span>
                        <span class="py-src-variable">axy</span>.<span class="py-src-variable">plot</span>(<span class="py-src-variable">df</span>.<span class="py-src-variable">index</span>, <span class="py-src-variable">df</span>[<span class="py-src-variable">collist</span>[<span class="py-src-variable">i</span>][<span class="py-src-variable">j</span>]], <span class="py-src-variable">linewidth</span> = <span class="py-src-number">0.4</span>, <span class="py-src-variable">color</span>= <span class="py-src-variable">colorlist</span>[<span class="py-src-variable">i</span>][<span class="py-src-variable">j</span>])
                        <span class="py-src-variable">axy</span>.<span class="py-src-variable">set_ylabel</span>(<span class="py-src-variable">collist</span>[<span class="py-src-variable">i</span>][<span class="py-src-variable">j</span>], **<span class="py-src-variable">axis_font</span>)
                        <span class="py-src-variable">axy</span>.<span class="py-src-variable">yaxis</span>.<span class="py-src-variable">label</span>.<span class="py-src-variable">set_color</span>(<span class="py-src-variable">colorlist</span>[<span class="py-src-variable">i</span>][<span class="py-src-variable">j</span>])
                        <span class="py-src-variable">axtwinlegend</span>.<span class="py-src-variable">append</span>(<span class="py-src-variable">collist</span>[<span class="py-src-variable">i</span>][<span class="py-src-variable">j</span>])
                <span class="py-src-keyword">if</span> <span class="py-src-variable">len</span>(<span class="py-src-variable">axlegend</span>)&gt;<span class="py-src-number">0</span>:
                    <span class="py-src-variable">ax</span>.<span class="py-src-variable">legend</span>(<span class="py-src-variable">axlegend</span>, <span class="py-src-variable">ncol</span>=<span class="py-src-variable">len</span>(<span class="py-src-variable">axlegend</span>)/<span class="py-src-number">2</span>+<span class="py-src-number">1</span>, <span class="py-src-variable">loc</span> = <span class="py-src-string">'upper left'</span>, <span class="py-src-variable">fontsize</span> = <span class="py-src-number">6</span>)
                <span class="py-src-keyword">if</span> <span class="py-src-variable">len</span>(<span class="py-src-variable">axtwinlegend</span>)&gt;<span class="py-src-number">0</span>:
                    <span class="py-src-variable">plt</span>.<span class="py-src-variable">legend</span>(<span class="py-src-variable">axtwinlegend</span>, <span class="py-src-variable">ncol</span>=<span class="py-src-variable">len</span>(<span class="py-src-variable">axtwinlegend</span>)/<span class="py-src-number">2</span>+<span class="py-src-number">1</span>, <span class="py-src-variable">loc</span> = <span class="py-src-string">'upper right'</span>, <span class="py-src-variable">fontsize</span> = <span class="py-src-number">6</span>)
                <span class="py-src-variable">ax</span>.<span class="py-src-variable">get_xaxis</span>().<span class="py-src-variable">set_ticks</span>([])
            <span class="py-src-keyword">else</span>:
                <span class="py-src-keyword">print</span> <span class="py-src-string">'Collist type error'</span>
        <span class="py-src-keyword">elif</span> <span class="py-src-string">'bar'</span> == <span class="py-src-variable">plottypelist</span>[<span class="py-src-variable">i</span>]:
            <span class="py-src-variable">plt</span>.<span class="py-src-variable">bar</span>(<span class="py-src-variable">df</span>.<span class="py-src-variable">index</span>,<span class="py-src-variable">df</span>[<span class="py-src-variable">collist</span>[<span class="py-src-variable">i</span>]], <span class="py-src-variable">alpha</span> = <span class="py-src-number">.5</span>,<span class="py-src-variable">color</span> = <span class="py-src-variable">colorlist</span>[<span class="py-src-variable">i</span>])
            <span class="py-src-variable">ax</span>.<span class="py-src-variable">get_xaxis</span>().<span class="py-src-variable">set_ticks</span>([])
            <span class="py-src-variable">plt</span>.<span class="py-src-variable">title</span>(<span class="py-src-variable">collist</span>[<span class="py-src-variable">i</span>])
        <span class="py-src-keyword">elif</span> <span class="py-src-string">'stack'</span> == <span class="py-src-variable">plottypelist</span>[<span class="py-src-variable">i</span>]:
            <span class="py-src-keyword">for</span> <span class="py-src-variable">j</span> <span class="py-src-keyword">in</span> <span class="py-src-variable">range</span>(<span class="py-src-variable">len</span>(<span class="py-src-variable">collist</span>[<span class="py-src-variable">i</span>])):
                <span class="py-src-variable">ax</span>.<span class="py-src-variable">bar</span>(<span class="py-src-variable">df</span>.<span class="py-src-variable">index</span>, <span class="py-src-variable">df</span>[<span class="py-src-variable">collist</span>[<span class="py-src-variable">i</span>][<span class="py-src-variable">j</span>]], <span class="py-src-variable">width</span>= <span class="py-src-number">.8</span>, <span class="py-src-variable">color</span>= <span class="py-src-variable">colorlist</span>[<span class="py-src-variable">i</span>][<span class="py-src-variable">j</span>], <span class="py-src-variable">bottom</span>=<span class="py-src-variable">bottomsum</span>, <span class="py-src-variable">alpha</span> = <span class="py-src-number">.7</span>)
                <span class="py-src-variable">bottomsum</span> = <span class="py-src-variable">bottomsum</span> + <span class="py-src-variable">df</span>[<span class="py-src-variable">collist</span>[<span class="py-src-variable">i</span>][<span class="py-src-variable">j</span>]]
            <span class="py-src-variable">plt</span>.<span class="py-src-variable">legend</span>(<span class="py-src-variable">collist</span>[<span class="py-src-variable">i</span>], <span class="py-src-variable">ncol</span> = <span class="py-src-variable">len</span>(<span class="py-src-variable">collist</span>[<span class="py-src-variable">i</span>])/<span class="py-src-number">2</span>+<span class="py-src-number">1</span>, <span class="py-src-variable">loc</span> = <span class="py-src-string">'upper center'</span>, <span class="py-src-variable">bbox_to_anchor</span>=(<span class="py-src-number">0.6</span>, <span class="py-src-number">1.0</span>), <span class="py-src-variable">fancybox</span>=<span class="py-src-variable">True</span>, <span class="py-src-variable">shadow</span>=<span class="py-src-variable">False</span>, <span class="py-src-variable">fontsize</span>= <span class="py-src-number">8</span>)
            <span class="py-src-variable">ax</span>.<span class="py-src-variable">set_ylabel</span>(<span class="py-src-string">'Mass concentration (ug/m3)'</span>, <span class="py-src-variable">fontdict</span> = <span class="py-src-variable">font</span>)
            <span class="py-src-variable">ax</span>.<span class="py-src-variable">xaxis</span>.<span class="py-src-variable">set_major_formatter</span>(<span class="py-src-variable">DateFormatter</span>(<span class="py-src-string">'%Y-%m-%d'</span>))
            <span class="py-src-variable">ax</span>.<span class="py-src-variable">xaxis</span>.<span class="py-src-variable">set_major_locator</span>(<span class="py-src-variable">DayLocator</span>())
            <span class="py-src-variable">plt</span>.<span class="py-src-variable">setp</span>(<span class="py-src-variable">plt</span>.<span class="py-src-variable">gca</span>().<span class="py-src-variable">get_xticklabels</span>(), <span class="py-src-variable">rotation</span> = <span class="py-src-number">90</span>, <span class="py-src-variable">horizontalalignment</span> = <span class="py-src-string">'left'</span>)
            <span class="py-src-variable">plt</span>.<span class="py-src-variable">grid</span>()
        <span class="py-src-keyword">else</span>:
            <span class="py-src-keyword">print</span> <span class="py-src-string">'Type error!!\n'</span>
    <span class="py-src-variable">plt</span>.<span class="py-src-variable">show</span>()
    <span class="py-src-keyword">return</span> <span class="py-src-number">0</span>
<span class="py-src-variable">df</span> = <span class="py-src-variable">pd</span>.<span class="py-src-variable">read_csv</span>(<span class="py-src-string">'sample.csv'</span>, <span class="py-src-variable">parse_dates</span> = <span class="py-src-variable">True</span>, <span class="py-src-variable">index_col</span> = <span class="py-src-string">'datetime'</span>)
<span class="py-src-variable">collist</span>= [<span class="py-src-string">'S/N'</span>, <span class="py-src-string">'OC/EC'</span>, [<span class="py-src-string">'EC'</span>, <span class="py-src-string">'sulfate'</span>,<span class="py-src-string">'OC'</span>,<span class="py-src-string">'Ca'</span>], [<span class="py-src-string">'nitrate'</span>, <span class="py-src-string">'ammonia'</span>, <span class="py-src-string">'chlorine'</span>, <span class="py-src-string">'potassoium'</span>]]
<span class="py-src-variable">plottypelist</span>= [<span class="py-src-string">'line'</span>, <span class="py-src-string">'bar'</span>,<span class="py-src-string">'line'</span>, <span class="py-src-string">'stack'</span>]
<span class="py-src-variable">directions</span>= [<span class="py-src-string">'L'</span>, <span class="py-src-string">'L'</span>,[<span class="py-src-string">'L'</span>,<span class="py-src-string">'L'</span>,<span class="py-src-string">'R'</span>, <span class="py-src-string">'R'</span>],[<span class="py-src-string">'L'</span>,<span class="py-src-string">'L'</span>,<span class="py-src-string">'L'</span>,<span class="py-src-string">'L'</span>]]
<span class="py-src-variable">colors</span>= [<span class="py-src-string">'r'</span>,<span class="py-src-string">'g'</span>,[<span class="py-src-string">'r'</span>, <span class="py-src-string">'g'</span>,<span class="py-src-string">'gold'</span>,<span class="py-src-string">'navy'</span>], [<span class="py-src-string">'b'</span>, <span class="py-src-string">'gold'</span>, <span class="py-src-string">'navy'</span>,  <span class="py-src-string">'tomato'</span>]]
<span class="py-src-variable">multiplot</span>(<span class="py-src-variable">df</span>,<span class="py-src-variable">collist</span>,<span class="py-src-variable">plottypelist</span>,<span class="py-src-variable">directions</span>,<span class="py-src-variable">colors</span>)
</pre>
</body>